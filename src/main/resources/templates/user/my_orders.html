<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{index :: parent(~{::#content}, ~{::title})}">
<head>
  <meta charset="UTF-8">
  <title>Gopal Shop | My Orders</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-linear-to-br from-blue-50 via-indigo-50 to-white min-h-screen">
    <div id="content">
  <section class="py-10 mt-10">
    <div class="container mx-auto px-4">

      <!-- Back Button -->
      <div class="flex justify-end mb-6">
        <a href="/user/home"
           class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105">
          ‚Üê Back
        </a>
      </div>

      <!-- Card -->
      <div class="bg-white shadow-2xl rounded-2xl p-8 border border-gray-100 transition transform hover:shadow-indigo-200 duration-300">

        <!-- Title -->
        <div class="text-center mb-6">
          <h1 class="text-3xl font-bold text-indigo-600 animate-fade-in">üì¶ My Orders</h1>

          <th:block th:if="${session.succMsg}">
            <p class="text-green-600 font-semibold mt-2 animate-fade-in">[[${session.succMsg}]]</p>
            <th:block th:text="${@commnServiceImpl.removeSessionMessage()}"></th:block>
          </th:block>

          <th:block th:if="${session.errorMsg}">
            <p class="text-red-500 font-semibold mt-2 animate-fade-in">[[${session.errorMsg}]]</p>
            <th:block th:text="${@commnServiceImpl.removeSessionMessage()}"></th:block>
          </th:block>
        </div>

        <!-- Orders Table -->
        <div class="overflow-x-auto">
          <table class="min-w-full border border-gray-200 rounded-lg overflow-hidden shadow-sm">
            <thead>
              <tr class="bg-indigo-600 text-white uppercase text-sm tracking-wider">
                <th class="py-3 px-4 text-left">Order ID</th>
                <th class="py-3 px-4 text-left">Date</th>
                <th class="py-3 px-4 text-left">Product Details</th>
                <th class="py-3 px-4 text-left">Price</th>
                <th class="py-3 px-4 text-left">Status</th>
                <th class="py-3 px-4 text-center">Action</th>
              </tr>
            </thead>

            <tbody class="divide-y divide-gray-200 text-gray-700">
              <tr th:each="o:${orders}" class="hover:bg-indigo-50 transition duration-300 ease-in-out">
                <td class="py-3 px-4 font-semibold text-gray-800">[[${o.orderId}]]</td>
                <td class="py-3 px-4">[[${o.orderDate}]]</td>
                <td class="py-3 px-4 font-medium">[[${o.product.title}]]</td>
                <td class="py-3 px-4">
                  <div class="text-sm">
                    <p>Quantity: <span class="font-semibold text-gray-800">[[${o.quantity}]]</span></p>
                    <p>Price: <span class="text-indigo-600 font-semibold">‚Çπ [[${o.price}]]</span></p>
                    <p>Total: <span class="text-green-600 font-semibold">‚Çπ [[${o.quantity * o.price}]]</span></p>
                  </div>
                </td>
                <td class="py-3 px-4">
                  <span th:classappend="${o.status == 'Cancelled'} ? 'bg-red-100 text-red-600' :
                                        ${o.status == 'Delivered'} ? 'bg-green-100 text-green-600' :
                                        'bg-yellow-100 text-yellow-700'"
                        class="px-3 py-1 rounded-full text-sm font-semibold shadow-sm">
                    [[${o.status}]]
                  </span>
                </td>

                <td class="py-3 px-4 text-center">
                  <th:block th:if="${o.status!='Cancelled'}">
                    <a th:href="@{'/user/update-status?id='+${o.id}+'&st=6'}"
                       class="bg-red-500 hover:bg-red-600 text-white text-sm px-3 py-1 rounded-lg shadow transition transform hover:scale-105">
                      Cancel
                    </a>
                  </th:block>

                  <th:block th:unless="${o.status!='Cancelled'}">
                    <button class="bg-gray-300 text-gray-500 text-sm px-3 py-1 rounded-lg cursor-not-allowed shadow-sm">
                      Cancelled
                    </button>
                  </th:block>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

      </div>
    </div>
  </section>

  <!-- Fade-in Animation -->
  <style>
    @keyframes fade-in {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in {
      animation: fade-in 0.7s ease-in-out;
    }
  </style>
</div>
</body>
</html>
